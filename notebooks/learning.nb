(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47652,        976]
NotebookOptionsPosition[     46217,        922]
NotebookOutlinePosition[     46557,        937]
CellTagsIndexPosition[     46514,        934]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["This notebook will guide you through the process of \
training the MSM/D model from binding data.",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.6167032942542725`*^9, 3.6167033276643486`*^9}}],

Cell[TextData[{
 StyleBox["Manually",
  FontColor->RGBColor[1, 0, 0]],
 " set root directory (where repository contents were unpacked) to ",
 StyleBox["fldr",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 " symbol."
}], "Text",
 CellChangeTimes->{{3.61668374010996*^9, 3.6166837431708713`*^9}, {
  3.6167016048177323`*^9, 3.616701676681406*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"fldr", "=", "\"\</sh2-cancer/\>\""}], ";", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "to", " ", "correct", " ", "folder", " ", "where", " ", 
    "repository", " ", "contents", " ", "were", " ", 
    RowBox[{"unpacked", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\"\<Done\>\""}]], "Input",
 CellChangeTimes->{{3.6166837447944145`*^9, 3.616683753518712*^9}, {
  3.616701521793441*^9, 3.6167015227466335`*^9}, {3.6167016596639233`*^9, 
  3.6167016650239654`*^9}, {3.6167020611214294`*^9, 3.616702074497651*^9}}],

Cell[BoxData["\<\"Done\"\>"], "Output",
 CellChangeTimes->{3.6166837537949743`*^9, 3.61670175928531*^9}]
}, {2}]],

Cell["Set other directories", "Text",
 CellChangeTimes->{{3.616701689964105*^9, 3.61670169310511*^9}, {
  3.6167017309856787`*^9, 3.616701736079791*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"fldrData", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"fldr", ",", "\"\<data\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fldrCode", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"fldr", ",", "\"\<code\>\""}], "}"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Done\>\""}], "Input",
 CellChangeTimes->{{3.6167017371111145`*^9, 3.6167017536910667`*^9}, {
  3.6167035214497128`*^9, 3.6167035240592723`*^9}, {3.6167109345997033`*^9, 
  3.6167109400066147`*^9}}],

Cell[BoxData["\<\"Done\"\>"], "Output",
 CellChangeTimes->{{3.6167017541442213`*^9, 3.6167017609729295`*^9}, 
   3.616710944757098*^9}]
}, {2}]],

Cell[TextData[{
 "Load ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " packages"
}], "Text",
 CellChangeTimes->{{3.6167109511327467`*^9, 3.61671095696152*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Get", "[", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{"fldrCode", ",", "#"}], "}"}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{"\"\<misc.wl\>\"", ",", "\"\<learning.wl\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Loaded\>\""}], "Input",
 CellChangeTimes->{{3.616710959039893*^9, 3.616711052706937*^9}, {
  3.6167111383102417`*^9, 3.6167111400604773`*^9}, {3.616711171705652*^9, 
  3.6167111718462873`*^9}}],

Cell[BoxData["\<\"Loaded\"\>"], "Output",
 CellChangeTimes->{3.6167110547853117`*^9}]
}, {2}]],

Cell[TextData[{
 "Load needed symbols. They are:",
 StyleBox["\n",
  FontFamily->"Arial Narrow"],
 StyleBox["matFourSourcesAveragedClosestPointContactMap",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 ": Average distances between residues in the SH2 domain and peptide derived \
from representative structures.\n",
 StyleBox["metadataSH2DomainsWithTandemFillsFiveSources",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 ": Metadata for all SH2 domains in the training set, including their amino \
acid sequences.",
 StyleBox["\n",
  FontSlant->"Italic"],
 StyleBox["metadataPeptidesTrimmedConcatenatedFiveSourcesAugmented",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 ": Metadata for all peptides in the training set, including their amino acid \
sequences.\n",
 StyleBox[\
"matsProbsNonRedundantConcatenatedWithTandemFillsFiveSourcesAugmentedSet1",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 ": Binary binding matrices for all biochemical binding experiments in the \
training set."
}], "Text",
 CellChangeTimes->{{3.616684916530792*^9, 3.6166849189951363`*^9}, {
  3.616703572720313*^9, 3.6167037256588287`*^9}, {3.6167037577242117`*^9, 
  3.616703759364955*^9}, {3.6167037923855696`*^9, 3.616703794057564*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LoadSymbol", "[", 
  RowBox[{"fldrData", ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
    "matFourSourcesAveragedClosestPointContactMap", ",", 
     "\[IndentingNewLine]", "metadataSH2DomainsWithTandemFillsFiveSources", 
     ",", "\[IndentingNewLine]", 
     "metadataPeptidesTrimmedConcatenatedFiveSourcesAugmented", ",", 
     "\[IndentingNewLine]", 
     "matsProbsNonRedundantConcatenatedWithTandemFillsFiveSourcesAugmentedSet1\
"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6166849204935613`*^9, 3.6166849440803356`*^9}, {
  3.616685185104393*^9, 3.616685185601866*^9}}],

Cell[BoxData["\<\"Loaded\"\>"], "Output",
 CellChangeTimes->{3.616684980447925*^9}]
}, {2}]],

Cell["\<\
Generate input matrices and feature distances vectors for use in R.\
\>", "Text",
 CellChangeTimes->{{3.616683617805634*^9, 3.6166836416743345`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"prefix", "=", "\"\<PNRFSAFSORNCNDPFBASCPC\>\""}], ",", 
      RowBox[{"fldr", "=", "fldrData"}], ",", 
      RowBox[{"cutoffMin", "=", "15"}], ",", 
      RowBox[{"cutoffMax", "=", "15"}], ",", 
      RowBox[{"matContacts", "=", 
       RowBox[{
       "matFourSourcesAveragedClosestPointContactMap", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{"mdSH2Domains", "=", 
       RowBox[{
       "metadataSH2DomainsWithTandemFillsFiveSources", "\[LeftDoubleBracket]", 
        RowBox[{"All", ",", "5"}], "\[RightDoubleBracket]"}]}], ",", 
      RowBox[{
      "mdPeptides", "=", 
       "metadataPeptidesTrimmedConcatenatedFiveSourcesAugmented"}], ",", 
      RowBox[{"alphaIncludedDomain", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"AlphaAAs", ",", "\"\<-\>\""}], "]"}]}], ",", 
      RowBox[{"alphaIncludedPeptide", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"AlphaAAs", ",", 
         RowBox[{"\"\<-\>\"", "|", "\"\<C\>\""}]}], "]"}]}], ",", 
      RowBox[{"alphaExcludedDomain", "=", 
       RowBox[{"{", "\"\<-\>\"", "}"}]}], ",", 
      RowBox[{"alphaExcludedPeptide", "=", 
       RowBox[{"{", 
        RowBox[{"\"\<-\>\"", ",", "\"\<C\>\""}], "}"}]}], ",", "dims", ",", 
      "matIFs", ",", "vecDists"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"pos", "=", 
          RowBox[{"Position", "[", 
           RowBox[{"matContacts", ",", 
            RowBox[{"d_", "/;", 
             RowBox[{"d", "<", "distCutoff"}]}], ",", "2"}], "]"}]}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"matIFs", "=", 
          RowBox[{"Parallelize", "[", 
           RowBox[{"Outer", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"SparseArray", "[", 
               RowBox[{"SequenceToPositionBasedFeatures", "[", 
                RowBox[{"##", ",", 
                 RowBox[{"SecondOrder", "\[Rule]", "pos"}], ",", 
                 RowBox[{"pY", "\[Rule]", "True"}], ",", 
                 RowBox[{
                 "IncludedResiduesDomain", "\[Rule]", "alphaIncludedDomain"}],
                  ",", 
                 RowBox[{
                 "IncludedResiduesPeptide", "\[Rule]", 
                  "alphaIncludedPeptide"}], ",", 
                 RowBox[{
                 "ExcludedResiduesDomain", "\[Rule]", "alphaExcludedDomain"}],
                  ",", 
                 RowBox[{
                 "ExcludedResiduesPeptide", "\[Rule]", 
                  "alphaExcludedPeptide"}]}], "]"}], "]"}], "&"}], ",", 
             "\[IndentingNewLine]", "mdSH2Domains", ",", 
             "\[IndentingNewLine]", "mdPeptides", ",", "\[IndentingNewLine]", 
             "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"vecDists", "=", 
          RowBox[{"SequenceToPositionBasedFeatures", "[", 
           RowBox[{
            RowBox[{
            "mdSH2Domains", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "mdPeptides", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"SecondOrder", "\[Rule]", "pos"}], ",", 
            RowBox[{"pY", "\[Rule]", "True"}], ",", 
            RowBox[{
            "IncludedResiduesDomain", "\[Rule]", "alphaIncludedDomain"}], ",", 
            RowBox[{
            "IncludedResiduesPeptide", "\[Rule]", "alphaIncludedPeptide"}], 
            ",", 
            RowBox[{
            "ExcludedResiduesDomain", "\[Rule]", "alphaExcludedDomain"}], ",", 
            RowBox[{
            "ExcludedResiduesPeptide", "\[Rule]", "alphaExcludedPeptide"}], 
            ",", 
            RowBox[{"Structured", "\[Rule]", "True"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"vecDists", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"ConstantArray", "[", 
             RowBox[{"0", ",", 
              RowBox[{"Length", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"vecDists", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}], "]"}], 
               "]"}]}], "]"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{"MapThread", "[", 
              RowBox[{"ConstantArray", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Extract", "[", 
                  RowBox[{"matContacts", ",", "pos"}], "]"}], ",", 
                 RowBox[{"Length", "/@", 
                  RowBox[{
                  "vecDists", "\[LeftDoubleBracket]", "3", 
                   "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}], "]"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"CreateDirectory", "[", 
          RowBox[{"FileNameJoin", "[", 
           RowBox[{"{", 
            RowBox[{"fldr", ",", 
             RowBox[{
             "\"\<rMatInput\>\"", "~~", "prefix", "~~", "\"\<Dist\>\"", "~~", 
              RowBox[{"ToString", "[", "distCutoff", "]"}]}]}], "}"}], "]"}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"MapIndexed", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Export", "[", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"FileNameJoin", "[", 
               RowBox[{"{", 
                RowBox[{"fldr", ",", 
                 RowBox[{
                 "\"\<rMatInput\>\"", "~~", "prefix", "~~", "\"\<Dist\>\"", "~~", 
                  RowBox[{"ToString", "[", "distCutoff", "]"}]}], ",", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{
                   "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], "~~", 
                  "\"\<.rsa\>\""}]}], "}"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"SetAccuracy", "[", 
               RowBox[{
                RowBox[{"SparseArray", "[", "#1", "]"}], ",", "5"}], "]"}]}], 
             "]"}], "&"}], ",", "\[IndentingNewLine]", "matIFs"}], "]"}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Export", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"FileNameJoin", "[", 
            RowBox[{"{", 
             RowBox[{"fldr", ",", 
              RowBox[{
              "\"\<rVecFeatureDist\>\"", "~~", "prefix", "~~", "\"\<Dist\>\"",
                "~~", 
               RowBox[{"ToString", "[", "distCutoff", "]"}]}]}], "}"}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"SetAccuracy", "[", 
            RowBox[{"vecDists", ",", "5"}], "]"}], ",", 
           "\[IndentingNewLine]", "\"\<List\>\""}], "]"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"distCutoff", ",", "cutoffMin", ",", "cutoffMax"}], "}"}]}], 
     "]"}]}], "]"}], ";"}], "\[IndentingNewLine]", "\"\<Done\>\""}], "Input",
 CellChangeTimes->{{3.536972907553114*^9, 3.5369730049406843`*^9}, {
   3.536973076253763*^9, 3.536973076580782*^9}, {3.536973112349828*^9, 
   3.5369731145979567`*^9}, {3.5369731632067366`*^9, 3.5369731748074*^9}, {
   3.5369732257823157`*^9, 3.5369732341497946`*^9}, {3.536973356086769*^9, 
   3.5369733591269426`*^9}, {3.5369740861345253`*^9, 3.536974342740202*^9}, {
   3.53697437277392*^9, 3.5369744158783855`*^9}, {3.536974450148346*^9, 
   3.5369745413235607`*^9}, {3.5369749273956423`*^9, 
   3.5369751339994593`*^9}, {3.5369752024073725`*^9, 
   3.5369752209234314`*^9}, {3.536980880585146*^9, 3.536980882435251*^9}, 
   3.536984208872513*^9, 3.537018850658892*^9, {3.537060512722826*^9, 
   3.537060512881835*^9}, {3.537060678650316*^9, 3.537060727377104*^9}, {
   3.53711464452036*^9, 3.5371146453714085`*^9}, {3.53711475554171*^9, 
   3.5371147800321107`*^9}, {3.5371148140640574`*^9, 3.53711481673521*^9}, {
   3.5371148932655873`*^9, 3.537114981590639*^9}, {3.5371150276152716`*^9, 
   3.537115035139702*^9}, {3.537116390006196*^9, 3.5371163988127*^9}, {
   3.537116455727955*^9, 3.537116508020946*^9}, {3.5375577336110277`*^9, 
   3.537557782849844*^9}, {3.5375579202987056`*^9, 3.5375579431310115`*^9}, {
   3.537557993418888*^9, 3.537558038179448*^9}, {3.5375580949046926`*^9, 
   3.5375580970818167`*^9}, {3.5375582382218895`*^9, 3.537558238621913*^9}, {
   3.537558410633751*^9, 3.5375584202002983`*^9}, {3.5375584515660925`*^9, 
   3.5375584550092893`*^9}, {3.538929242497173*^9, 3.5389292501567864`*^9}, {
   3.539359794697087*^9, 3.539359813434719*^9}, {3.5449098575216165`*^9, 
   3.544909857720628*^9}, 3.5449220989477863`*^9, {3.544922174842127*^9, 
   3.5449221850657115`*^9}, 3.5449223768086786`*^9, {3.544922416761964*^9, 
   3.5449224259984922`*^9}, {3.544924222198229*^9, 3.54492424337444*^9}, {
   3.544924345964308*^9, 3.544924355561857*^9}, {3.544964414288085*^9, 
   3.5449644272538266`*^9}, {3.544980745765192*^9, 3.5449807459021997`*^9}, {
   3.545053899274334*^9, 3.5450538994993467`*^9}, {3.561310158761444*^9, 
   3.561310165516306*^9}, 3.561310283033292*^9, {3.561310376244179*^9, 
   3.5613103941484623`*^9}, {3.5613106819091587`*^9, 3.561310692835552*^9}, {
   3.5613113826945267`*^9, 3.5613114295054965`*^9}, {3.5613114620786505`*^9, 
   3.561311462787741*^9}, {3.5613126023310604`*^9, 3.561312603439203*^9}, {
   3.5613126446074524`*^9, 3.561312693163645*^9}, {3.561312736693197*^9, 
   3.561312830208121*^9}, {3.5613131689293165`*^9, 3.561313194576587*^9}, {
   3.561313537992381*^9, 3.561313574195998*^9}, {3.561313607742276*^9, 
   3.561313642175668*^9}, {3.5613137275325527`*^9, 3.5613137805183096`*^9}, 
   3.5613138440924172`*^9, {3.561403402627385*^9, 3.561403415702053*^9}, {
   3.561849757436922*^9, 3.5618497577549634`*^9}, {3.565353420756448*^9, 
   3.5653534213960543`*^9}, {3.565361055975627*^9, 3.5653611558602448`*^9}, {
   3.565361200491499*^9, 3.565361221768916*^9}, 3.5653612640167484`*^9, {
   3.5653638688028173`*^9, 3.565363872702856*^9}, {3.566476673402275*^9, 
   3.566476741639371*^9}, 3.5664768036144*^9, {3.5920682694098983`*^9, 
   3.592068270472474*^9}, {3.5920685048116226`*^9, 3.5920685606145887`*^9}, {
   3.5920685921328135`*^9, 3.5920685955090714`*^9}, {3.5920687013016872`*^9, 
   3.5920687293521805`*^9}, {3.5920688592278633`*^9, 
   3.5920688594153757`*^9}, {3.5920688955468483`*^9, 
   3.5920689325672183`*^9}, {3.5920692514355755`*^9, 
   3.5920692578326654`*^9}, {3.5920693064092455`*^9, 
   3.5920693119074774`*^9}, {3.5920694224087214`*^9, 
   3.5920694337532873`*^9}, {3.5920695055438976`*^9, 
   3.5920695144981947`*^9}, {3.592674110567715*^9, 3.5926741115209103`*^9}, {
   3.5926754534993796`*^9, 3.5926754559997387`*^9}, {3.5926754960834246`*^9, 
   3.5926754992711563`*^9}, {3.5926755749367976`*^9, 3.5926755864220004`*^9}, 
   3.5926767430461063`*^9, {3.5926768048700504`*^9, 3.5926768560099936`*^9}, {
   3.5926768862948923`*^9, 3.5926769316920967`*^9}, {3.5926769915597076`*^9, 
   3.59267707893451*^9}, {3.5926771312864723`*^9, 3.5926771444749203`*^9}, {
   3.592679208817818*^9, 3.5926792141307*^9}, {3.592679292640936*^9, 
   3.592679314458932*^9}, {3.592679417007701*^9, 3.5926794228372765`*^9}, {
   3.5926795062731957`*^9, 3.5926795070545025`*^9}, {3.5926795454215355`*^9, 
   3.5926795539377723`*^9}, {3.5926797752415667`*^9, 3.5926797829296207`*^9}, 
   3.592680655578642*^9, {3.592680936190293*^9, 3.5926809433315945`*^9}, {
   3.5926812315213118`*^9, 3.5926812326473618`*^9}, {3.5926814245780697`*^9, 
   3.5926814278401737`*^9}, {3.5926814639207706`*^9, 
   3.5926814640869255`*^9}, {3.5926831303316555`*^9, 
   3.5926831718998404`*^9}, {3.5926832255537086`*^9, 3.592683227803874*^9}, {
   3.592683403480668*^9, 3.592683410804638*^9}, {3.5928599561143723`*^9, 
   3.5928599572814827`*^9}, {3.5928606265802393`*^9, 
   3.5928606839632597`*^9}, {3.592860728063184*^9, 3.5928607300945787`*^9}, {
   3.592868325098294*^9, 3.5928684146915846`*^9}, 3.5928684802510405`*^9, {
   3.593777102136837*^9, 3.593777132924262*^9}, {3.593777241018943*^9, 
   3.593777251801215*^9}, {3.5937773048853345`*^9, 3.5937773051353493`*^9}, {
   3.593777388552903*^9, 3.5937774783188825`*^9}, {3.593778260644918*^9, 
   3.5937782692725925`*^9}, {3.593778310185788*^9, 3.5937783230630283`*^9}, {
   3.5937784042968035`*^9, 3.593778479872218*^9}, {3.593778568980727*^9, 
   3.593778579888319*^9}, {3.5937786319445114`*^9, 3.593778632350918*^9}, {
   3.59377866758995*^9, 3.5937787276180787`*^9}, {3.593779417172063*^9, 
   3.5937794203912587`*^9}, {3.5937796958245993`*^9, 
   3.5937797044973993`*^9}, {3.5937800295547047`*^9, 
   3.5937800442757645`*^9}, {3.603644825199027*^9, 3.6036448306370773`*^9}, {
   3.6166836626102495`*^9, 3.616683664787318*^9}, 3.6166837726645393`*^9, {
   3.616689869162882*^9, 3.616689870287959*^9}}],

Cell[BoxData["\<\"Done\"\>"], "Output",
 CellChangeTimes->{3.616683679209036*^9}]
}, {2}]],

Cell["Generate response matrices for use in R.", "Text",
 CellChangeTimes->{{3.6166851404420996`*^9, 3.616685144913351*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"fldr", "=", "fldrData"}], ",", "\[IndentingNewLine]", 
      RowBox[{"prefix", "=", "\"\<PNRFSAFSORNCNDPFBASCPC\>\""}], ",", 
      RowBox[{"postfix", "=", "\"\<Set1\>\""}], ",", 
      RowBox[{
      "matsProbs", "=", 
       "matsProbsNonRedundantConcatenatedWithTandemFillsFiveSourcesAugmentedSe\
t1"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"Export", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FileNameJoin", "[", 
       RowBox[{"{", 
        RowBox[{"fldr", ",", 
         RowBox[{
         "\"\<rMatResponse\>\"", "~~", "prefix", "~~", "postfix", "~~", 
          "\"\<.rsa\>\""}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"SetAccuracy", "[", 
       RowBox[{
        RowBox[{"SparseArray", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"matsProbs", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "1", "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}], "}"}]}], "]"}], "]"}], ",", 
        "5"}], "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", "\"\<Done\>\""}], "Input",
 CellChangeTimes->{{3.536972907553114*^9, 3.5369730049406843`*^9}, {
   3.536973076253763*^9, 3.536973076580782*^9}, {3.536973112349828*^9, 
   3.5369731145979567`*^9}, {3.5369731632067366`*^9, 3.5369731748074*^9}, {
   3.5369732257823157`*^9, 3.5369732341497946`*^9}, {3.536973356086769*^9, 
   3.5369733591269426`*^9}, {3.5369740861345253`*^9, 3.536974342740202*^9}, {
   3.53697437277392*^9, 3.5369744158783855`*^9}, {3.536974450148346*^9, 
   3.5369745413235607`*^9}, {3.5369749273956423`*^9, 
   3.5369751339994593`*^9}, {3.5369752024073725`*^9, 
   3.5369752209234314`*^9}, {3.536980880585146*^9, 3.536980882435251*^9}, 
   3.536984208872513*^9, 3.537018850658892*^9, {3.537060512722826*^9, 
   3.537060512881835*^9}, {3.537060678650316*^9, 3.537060727377104*^9}, {
   3.53711464452036*^9, 3.5371146453714085`*^9}, {3.53711475554171*^9, 
   3.5371147800321107`*^9}, {3.5371148140640574`*^9, 3.53711481673521*^9}, {
   3.5371148932655873`*^9, 3.537114981590639*^9}, {3.5371150276152716`*^9, 
   3.537115035139702*^9}, {3.537116390006196*^9, 3.5371163988127*^9}, {
   3.537116455727955*^9, 3.537116508020946*^9}, {3.5375577336110277`*^9, 
   3.537557782849844*^9}, {3.5375579202987056`*^9, 3.5375579431310115`*^9}, {
   3.537557993418888*^9, 3.537558038179448*^9}, {3.5375580949046926`*^9, 
   3.5375580970818167`*^9}, {3.5375582382218895`*^9, 3.537558238621913*^9}, {
   3.537558410633751*^9, 3.5375584202002983`*^9}, {3.5375584515660925`*^9, 
   3.5375584550092893`*^9}, {3.538929242497173*^9, 3.5389292501567864`*^9}, {
   3.539359794697087*^9, 3.539359813434719*^9}, {3.5449098575216165`*^9, 
   3.544909857720628*^9}, 3.5449220989477863`*^9, {3.544922174842127*^9, 
   3.5449221850657115`*^9}, 3.5449223768086786`*^9, {3.544922416761964*^9, 
   3.5449224259984922`*^9}, {3.544924222198229*^9, 3.54492424337444*^9}, {
   3.544924345964308*^9, 3.544924355561857*^9}, {3.544964414288085*^9, 
   3.5449644272538266`*^9}, {3.544980745765192*^9, 3.5449807459021997`*^9}, {
   3.545053899274334*^9, 3.5450538994993467`*^9}, {3.561310158761444*^9, 
   3.561310165516306*^9}, 3.561310283033292*^9, {3.561310376244179*^9, 
   3.5613103941484623`*^9}, {3.5613106819091587`*^9, 3.561310692835552*^9}, {
   3.5613113826945267`*^9, 3.5613114295054965`*^9}, {3.5613114620786505`*^9, 
   3.561311462787741*^9}, {3.5613126023310604`*^9, 3.561312603439203*^9}, {
   3.5613126446074524`*^9, 3.561312693163645*^9}, {3.561312736693197*^9, 
   3.561312830208121*^9}, {3.5613131689293165`*^9, 3.561313194576587*^9}, {
   3.561313537992381*^9, 3.561313574195998*^9}, {3.561313607742276*^9, 
   3.561313642175668*^9}, {3.5613137275325527`*^9, 3.5613137805183096`*^9}, 
   3.5613138440924172`*^9, {3.561403402627385*^9, 3.561403415702053*^9}, {
   3.561849757436922*^9, 3.5618497577549634`*^9}, {3.565353420756448*^9, 
   3.5653534213960543`*^9}, {3.565361055975627*^9, 3.5653611558602448`*^9}, {
   3.565361200491499*^9, 3.565361221768916*^9}, 3.5653612640167484`*^9, {
   3.5653638688028173`*^9, 3.565363872702856*^9}, {3.566476673402275*^9, 
   3.566476741639371*^9}, 3.5664768036144*^9, {3.5920682694098983`*^9, 
   3.592068270472474*^9}, {3.5920685048116226`*^9, 3.5920685606145887`*^9}, {
   3.5920685921328135`*^9, 3.5920685955090714`*^9}, {3.5920687013016872`*^9, 
   3.5920687293521805`*^9}, {3.5920688592278633`*^9, 
   3.5920688594153757`*^9}, {3.5920688955468483`*^9, 
   3.5920689325672183`*^9}, {3.5920692514355755`*^9, 
   3.5920692578326654`*^9}, {3.5920693064092455`*^9, 
   3.5920693119074774`*^9}, {3.5920694224087214`*^9, 
   3.5920694337532873`*^9}, {3.5920695055438976`*^9, 
   3.5920695144981947`*^9}, {3.592674110567715*^9, 3.5926741115209103`*^9}, {
   3.5926754534993796`*^9, 3.5926754559997387`*^9}, {3.5926754960834246`*^9, 
   3.5926754992711563`*^9}, {3.5926755749367976`*^9, 3.5926755864220004`*^9}, 
   3.5926767430461063`*^9, {3.5926768048700504`*^9, 3.5926768560099936`*^9}, {
   3.5926768862948923`*^9, 3.5926769316920967`*^9}, {3.5926769915597076`*^9, 
   3.59267707893451*^9}, {3.5926771312864723`*^9, 3.5926771444749203`*^9}, {
   3.592679208817818*^9, 3.5926792141307*^9}, {3.5926793235689626`*^9, 
   3.5926793616363983`*^9}, {3.5926794002399592`*^9, 3.592679429995777*^9}, {
   3.5926795093984184`*^9, 3.5926795098672028`*^9}, 3.5926843822774973`*^9, 
   3.592684414061037*^9, {3.592684470753627*^9, 3.592684473878852*^9}, {
   3.5926845365093713`*^9, 3.5926845811375837`*^9}, {3.6036456816671643`*^9, 
   3.6036456847410803`*^9}, {3.616685151557486*^9, 3.6166851759166546`*^9}, {
   3.6166899009786263`*^9, 3.6166899019478564`*^9}}],

Cell[BoxData["\<\"Done\"\>"], "Output",
 CellChangeTimes->{3.616685155280027*^9}]
}, {2}]],

Cell[TextData[{
 "Execute bash script to train MSM/D model in R. ",
 StyleBox["fldr",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 " environmental variable must be ",
 StyleBox["manually",
  FontColor->RGBColor[1, 0, 0]],
 " set to root directory. (Note: Potentially computationally intensive; \
recommended to be run on compute cluster. Insure that all necessary R \
packages are installed.)"
}], "Text",
 CellChangeTimes->{{3.6166897616350307`*^9, 3.6166897716517067`*^9}, {
  3.6166903237163243`*^9, 3.616690339672228*^9}, {3.616690565604146*^9, 
  3.6166905669323664`*^9}, {3.6167012459344745`*^9, 3.6167012681402955`*^9}, {
  3.61670152976296*^9, 3.61670154803048*^9}, {3.616701707061262*^9, 
  3.616701708311482*^9}, {3.6167017754429216`*^9, 3.616701775739815*^9}, {
  3.6167018175723557`*^9, 3.6167018191662226`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"#", "!"}], "/", "bin"}], "/", "bash"}], "\n"}], "\n", 
 RowBox[{"fldr", "=", 
  RowBox[{
   RowBox[{
   "\"\</sh2-cancer/\>\"", " ", "#Set", " ", "to", " ", "correct", " ", 
    "folder", " ", "where", " ", "repository", " ", "contents", " ", "were", 
    " ", 
    RowBox[{"unpacked", ".", "\n", "fldrData"}]}], "=", 
   RowBox[{"$", 
    RowBox[{"{", "fldr", "}"}], "\"\<data/\>\""}]}]}], "\n", 
 RowBox[{
  RowBox[{"fldrCode", "=", 
   RowBox[{"$", 
    RowBox[{"{", "fldr", "}"}], "\"\<code/\>\""}]}], "\n"}], "\n", 
 RowBox[{"nodes", "=", "1"}], "\n", 
 RowBox[{"prefixData", "=", "\"\<PNRFSA\>\""}], "\n", 
 RowBox[{"infixData", "=", "\"\<FSORNCNDPFBASCPC\>\""}], "\n", 
 RowBox[{"postfixData", "=", "\"\<Set1\>\""}], "\n", 
 RowBox[{"prefixDataPrediction", "=", "\"\<\>\""}], "\n", 
 RowBox[{"mode", "=", "\"\<Training\>\""}], "\n", 
 RowBox[{"precomputedlambdas", "=", "\"\<TRUE\>\""}], "\n", 
 RowBox[{"nlambda", "=", "\"\<200\>\""}], "\n", 
 RowBox[{"nlambdaminratio", "=", "\"\<0.000001\>\""}], "\n", 
 RowBox[{"nlambdapredidx", "=", "\"\<-1\>\""}], "\n", 
 RowBox[{
  RowBox[{"grid", "=", "\"\<as.matrix(rbind(c(1,1,0.9)))\>\""}], "\n"}], "\n", 
 RowBox[{
  RowBox[{"for", " ", "dist", " ", "in", " ", "15"}], ";", " ", "do"}], "\n", 
 RowBox[{" ", 
  RowBox[{
   RowBox[{"for", " ", "cv", " ", "in", " ", "\"\<AllRandomFT\>\""}], ";", 
   " ", "do"}]}], "\n", 
 RowBox[{"  ", 
  RowBox[{
   RowBox[{"for", " ", "cvprefix", " ", "in", " ", "\"\<NoNegOne\>\""}], ";", 
   " ", "do"}]}], "\n", 
 RowBox[{"   ", 
  RowBox[{
   RowBox[{"for", " ", "gridselection", " ", "in", " ", "1"}], ";", " ", 
   "do"}]}], "\n", 
 RowBox[{"    ", 
  RowBox[{
   RowBox[{"for", " ", "varweight", " ", "in", " ", "\"\<FALSE\>\""}], ";", 
   " ", "do"}]}], "\n", 
 RowBox[{"     ", 
  RowBox[{
   RowBox[{"for", " ", "output", " ", "in", " ", "1"}], ";", " ", 
   "do"}]}], "\n", 
 RowBox[{"      ", 
  RowBox[{
   RowBox[{
    RowBox[{"for", " ", "lvl1cv", " ", "in"}], " ", "-", "1"}], ";", " ", 
   "do"}]}], "\n", 
 RowBox[{" \t  ", 
  RowBox[{
   RowBox[{
    RowBox[{"for", " ", "lvl2cv", " ", "in"}], " ", "-", "1"}], ";", " ", 
   "do"}]}], "\n", 
 RowBox[{"\t\t", 
  RowBox[{
   RowBox[{
    RowBox[{"for", " ", "predset", " ", "in"}], " ", "-", "1"}], ";", " ", 
   "do"}]}], "\n", 
 RowBox[{"\t     ", 
  RowBox[{
   RowBox[{"for", " ", "chunks", " ", "in", " ", "1"}], ";", " ", 
   "do"}]}], "\n", 
 RowBox[{" \t     ", 
  RowBox[{
   RowBox[{"for", " ", "intercept", " ", "in", " ", "\"\<TRUE\>\""}], ";", 
   " ", "do"}], " "}], "\n", 
 RowBox[{"\t\t   ", 
  RowBox[{"Rscript", " ", "$", 
   RowBox[{"{", "fldrCode", "}"}], 
   RowBox[{"learning", ".", "R"}], " ", "\"\<\\\"${prefixData}\\\"\>\"", " ", 
   "\"\<\\\"${infixData}\\\"\>\"", " ", "\"\<\\\"${postfixData}\\\"\>\"", 
   " ", "\"\<\\\"${prefixDataPrediction}\\\"\>\"", " ", 
   "\"\<\\\"${mode}\\\"\>\"", " ", "\"\<${precomputedlambdas}\>\"", " ", 
   "\"\<${dist}\>\"", " ", "\"\<\\\"${cv}\\\"\>\"", " ", 
   "\"\<\\\"${cvprefix}\\\"\>\"", " ", "\"\<${output}\>\"", " ", 
   "\"\<${lvl1cv}\>\"", " ", "\"\<${lvl2cv}\>\"", " ", "\"\<${predset}\>\"", 
   " ", "\"\<${chunks}\>\"", " ", "\"\<${intercept}\>\"", " ", 
   "\"\<${varweight}\>\"", " ", "\"\<\\\"${grid}\\\"\>\"", " ", 
   "\"\<${gridselection}\>\"", " ", "\"\<${nlambda}\>\"", " ", 
   "\"\<${nlambdaminratio}\>\"", " ", "\"\<${nlambdapredidx}\>\"", " ", 
   "\"\<${nodes}\>\"", " ", "\"\<\\\"${fldrData}\\\"\>\""}]}], "\n", 
 RowBox[{"\t\t  ", "done"}], "\n", 
 RowBox[{"\t\t ", "done"}], "\n", 
 RowBox[{"\t\t", "done"}], "\n", 
 RowBox[{"\t   ", "done"}], "\n", 
 RowBox[{"\t  ", "done"}], "\n", 
 RowBox[{"\t ", "done"}], "\n", 
 RowBox[{"\t", "done"}], "\n", 
 RowBox[{"   ", "done"}], "\n", 
 RowBox[{"  ", "done"}], "\n", 
 RowBox[{" ", "done"}], "\n", 
 RowBox[{"done", "  "}]}], "Code",
 InitializationCell->False,
 CellChangeTimes->{
  3.537214553615477*^9, {3.537214595115851*^9, 3.537214596273917*^9}, 
   3.53721497064333*^9, {3.53721724263628*^9, 3.537217242824291*^9}, 
   3.537239256542404*^9, 3.537239628616685*^9, {3.5372399854560957`*^9, 
   3.537239986335146*^9}, {3.5375586970031304`*^9, 3.5375586973231487`*^9}, {
   3.537559077178875*^9, 3.5375590838702583`*^9}, {3.5375591371813073`*^9, 
   3.5375591836589656`*^9}, 3.5375596534418354`*^9, 3.5375604500573997`*^9, {
   3.5376298972040386`*^9, 3.5376298972230396`*^9}, {3.537634433611506*^9, 
   3.5376344336375074`*^9}, {3.537634469396553*^9, 3.5376344696005645`*^9}, {
   3.5376345838620996`*^9, 3.53763458472915*^9}, {3.5376372250241656`*^9, 
   3.537637239295982*^9}, {3.537637299192408*^9, 3.537637405480487*^9}, {
   3.5376374374803176`*^9, 3.5376374895992985`*^9}, {3.537637535224908*^9, 
   3.5376375403292003`*^9}, {3.537637594088275*^9, 3.5376376586139655`*^9}, {
   3.537637690791806*^9, 3.5376377940867147`*^9}, {3.538773748501616*^9, 
   3.53877375451396*^9}, {3.5387739498961353`*^9, 3.538773950522171*^9}, {
   3.538773983457055*^9, 3.5387740126317234`*^9}, {3.5389292691576195`*^9, 
   3.5389292975496693`*^9}, {3.539293974520624*^9, 3.539293974661024*^9}, {
   3.539294084198024*^9, 3.539294086139428*^9}, {3.539359866896013*^9, 
   3.53935990520968*^9}, {3.5395273450438304`*^9, 3.5395273451998305`*^9}, {
   3.539527405348528*^9, 3.5395274055981283`*^9}, {3.5424146298386717`*^9, 
   3.542414638947193*^9}, 3.5424616170500574`*^9, {3.542461848435173*^9, 
   3.542461851043378*^9}, {3.545054163407441*^9, 3.545054188722889*^9}, {
   3.54505425972795*^9, 3.5450542904057045`*^9}, 3.5450544432604475`*^9, {
   3.56131539800858*^9, 3.561315449270117*^9}, {3.5613158032822633`*^9, 
   3.5613158034562855`*^9}, {3.5618497898660827`*^9, 3.561849790023102*^9}, {
   3.563836565824712*^9, 3.563836591728015*^9}, {3.5653534781786337`*^9, 
   3.5653534782410345`*^9}, 3.5653536415210114`*^9, {3.5666464776035366`*^9, 
   3.566646479294355*^9}, {3.5928615543172483`*^9, 3.592861593919598*^9}, {
   3.592861861558495*^9, 3.5928619033626356`*^9}, {3.59286196290261*^9, 
   3.5928619692453613`*^9}, {3.5928620028413124`*^9, 
   3.5928620281497564`*^9}, {3.5928685859472284`*^9, 3.592868599243154*^9}, {
   3.592869302382321*^9, 3.5928694153741865`*^9}, {3.592869542596611*^9, 
   3.5928695454945145`*^9}, {3.5928699771424885`*^9, 
   3.5928701163560095`*^9}, {3.5928701680666504`*^9, 3.592870243814892*^9}, {
   3.592870282056675*^9, 3.5928702906858582`*^9}, {3.59287040416159*^9, 
   3.592870505751789*^9}, {3.5929463551632676`*^9, 3.59294643214771*^9}, {
   3.593190540793373*^9, 3.593190600433544*^9}, {3.593190641535048*^9, 
   3.593190644379006*^9}, {3.593190679032857*^9, 3.593190723304124*^9}, {
   3.5931908467690554`*^9, 3.5931908622233076`*^9}, {3.5931909693507357`*^9, 
   3.593191046464634*^9}, {3.59321049391267*^9, 3.5932105122554636`*^9}, {
   3.5932106001689477`*^9, 3.5932106018616533`*^9}, {3.5932106751978865`*^9, 
   3.5932108367383604`*^9}, {3.593210967722492*^9, 3.593211045898735*^9}, {
   3.5932135155258117`*^9, 3.5932135582636423`*^9}, {3.593213654814946*^9, 
   3.593213800303253*^9}, {3.5932138736969824`*^9, 3.593213887901355*^9}, {
   3.593213954088632*^9, 3.593213968198428*^9}, {3.5932672616454687`*^9, 
   3.593267297899086*^9}, {3.593267340241522*^9, 3.5932673787422867`*^9}, {
   3.593267533937626*^9, 3.5932675349383054`*^9}, {3.5932677688362455`*^9, 
   3.593267851529851*^9}, {3.5932680951001606`*^9, 3.5932680984761806`*^9}, {
   3.5932682146190367`*^9, 3.593268262739024*^9}, {3.5932683335520864`*^9, 
   3.5932683554294744`*^9}, 3.5932684067226033`*^9, {3.5932823254640656`*^9, 
   3.59328233498748*^9}, {3.593293753793527*^9, 3.5932938842052727`*^9}, {
   3.5932939147605314`*^9, 3.593293939410692*^9}, {3.59329397577094*^9, 
   3.5932940543683834`*^9}, {3.593294094062111*^9, 3.59329409950002*^9}, {
   3.593294182379959*^9, 3.5932941852084956`*^9}, {3.5932942173271008`*^9, 
   3.5932942531728735`*^9}, 3.5933016354140425`*^9, 3.593341768530216*^9, {
   3.5933418524327335`*^9, 3.5933418527300196`*^9}, {3.5933422913457413`*^9, 
   3.593342318677763*^9}, 3.5933423586973405`*^9, {3.5933589532118406`*^9, 
   3.5933589552588625`*^9}, {3.593364431528453*^9, 3.5933644330482388`*^9}, {
   3.5933648109298334`*^9, 3.593364811937795*^9}, {3.5933705260215297`*^9, 
   3.593370531221571*^9}, {3.5933707829796357`*^9, 3.59337085221863*^9}, {
   3.593370975769277*^9, 3.593371049059707*^9}, {3.593371091946333*^9, 
   3.5933712932149925`*^9}, {3.593780147279165*^9, 3.5937801517483377`*^9}, {
   3.593780278814123*^9, 3.5937802807517605`*^9}, {3.5937805034181447`*^9, 
   3.5937805689771986`*^9}, {3.5937815207177505`*^9, 
   3.5937815303125196`*^9}, {3.593781614896077*^9, 3.5937817721209955`*^9}, {
   3.593782042177019*^9, 3.5937820528031263`*^9}, {3.593782333907153*^9, 
   3.593782354461903*^9}, {3.593782856831827*^9, 3.593782912817055*^9}, {
   3.5937862291191416`*^9, 3.593786232510988*^9}, {3.5937862669699593`*^9, 
   3.5937862872135935`*^9}, {3.593786349313732*^9, 3.5937863507212706`*^9}, {
   3.5937863887329564`*^9, 3.5937864255957623`*^9}, {3.593786457926697*^9, 
   3.593786640632837*^9}, {3.593793167088247*^9, 3.5937932318855143`*^9}, {
   3.5937933090893755`*^9, 3.593793329712121*^9}, {3.5937933959732976`*^9, 
   3.5937934788835344`*^9}, 3.593793661526273*^9, {3.593793699465478*^9, 
   3.593793725789179*^9}, {3.593793812900052*^9, 3.593793877618389*^9}, {
   3.593793964541884*^9, 3.593794031771307*^9}, {3.593794068589266*^9, 
   3.5937940705876045`*^9}, 3.59379545413081*^9, 3.5937979313556952`*^9, 
   3.5937984164971895`*^9, {3.5937987856638737`*^9, 3.593798788180975*^9}, 
   3.593800623546874*^9, 3.5938102849124064`*^9, 3.5938103197149506`*^9, {
   3.5938103638444433`*^9, 3.5938103643757353`*^9}, {3.5938104377752123`*^9, 
   3.5938104392379417`*^9}, {3.593810488529045*^9, 3.593810490966832*^9}, {
   3.5938116219724665`*^9, 3.5938116352134132`*^9}, {3.5938147461809945`*^9, 
   3.593814769396807*^9}, {3.593814853532323*^9, 3.5938148986467605`*^9}, {
   3.5938155721271505`*^9, 3.5938156141447744`*^9}, {3.5938177040571575`*^9, 
   3.5938177788111343`*^9}, {3.5938178091664886`*^9, 3.593817848615263*^9}, {
   3.5938650744327393`*^9, 3.5938651020344696`*^9}, {3.5938651352568483`*^9, 
   3.593865185120159*^9}, {3.593865222358892*^9, 3.593865264328727*^9}, {
   3.5938652988514137`*^9, 3.5938652997729616`*^9}, {3.593867162828945*^9, 
   3.5938671638915167`*^9}, {3.5938674178140416`*^9, 
   3.5938674187062435`*^9}, {3.593873905612504*^9, 3.593873906675147*^9}, {
   3.5938826577363563`*^9, 3.5938826583145247`*^9}, {3.5938838125585613`*^9, 
   3.5938838231390934`*^9}, {3.593884070450811*^9, 3.5938840770794444`*^9}, {
   3.5938899468425937`*^9, 3.5938899469845886`*^9}, {3.593890063111514*^9, 
   3.5938900862429676`*^9}, {3.59389012637846*^9, 3.593890138881009*^9}, {
   3.5938901741006994`*^9, 3.59389020689413*^9}, {3.593890738702047*^9, 
   3.5938908932071342`*^9}, {3.593891017107091*^9, 3.59389106224208*^9}, {
   3.593891105392462*^9, 3.593891171517318*^9}, {3.5938915912316093`*^9, 
   3.593891642162401*^9}, {3.593891681469059*^9, 3.593891714473172*^9}, 
   3.593891779406389*^9, {3.593892470181893*^9, 3.5938924832615056`*^9}, {
   3.593892537470689*^9, 3.593892540861751*^9}, {3.5938945496878304`*^9, 
   3.5938945547197647`*^9}, {3.5938946554520845`*^9, 
   3.5938946676253543`*^9}, {3.5938947606701236`*^9, 
   3.5938947643112087`*^9}, {3.593894798414291*^9, 3.5938948582814493`*^9}, {
   3.5938954507993393`*^9, 3.5938954776944036`*^9}, {3.5938962846387367`*^9, 
   3.5938963469042387`*^9}, {3.593896384209114*^9, 3.593896427159552*^9}, {
   3.5939075590600295`*^9, 3.593907566377189*^9}, {3.5939079908900647`*^9, 
   3.593908004940555*^9}, {3.5939080417049866`*^9, 3.593908045283471*^9}, {
   3.5939082751548615`*^9, 3.593908283250554*^9}, {3.5939083147922096`*^9, 
   3.5939083385934362`*^9}, {3.5939083742917404`*^9, 3.593908390904252*^9}, {
   3.5939089988768187`*^9, 3.5939090795622063`*^9}, {3.5939091334145017`*^9, 
   3.59390913374265*^9}, {3.5939091797493324`*^9, 3.593909323246521*^9}, 
   3.593911195217198*^9, {3.5939116899551945`*^9, 3.5939116905646124`*^9}, {
   3.5939847999245825`*^9, 3.593984803331235*^9}, {3.593985293092003*^9, 
   3.59398535662409*^9}, {3.593988741535966*^9, 3.5939888258744946`*^9}, {
   3.5939889249145384`*^9, 3.5939889310882564`*^9}, {3.5939955738871145`*^9, 
   3.593995663699691*^9}, {3.593995706137636*^9, 3.5939957094507537`*^9}, {
   3.594036605499155*^9, 3.594036607108759*^9}, {3.596369333561591*^9, 
   3.5963693566292477`*^9}, {3.5963701282970967`*^9, 
   3.5963701920751486`*^9}, {3.5963763757933726`*^9, 
   3.5963764355254364`*^9}, {3.5963771234537625`*^9, 
   3.5963771238757725`*^9}, {3.5963802442403116`*^9, 3.596380320424218*^9}, {
   3.596382752351136*^9, 3.5963827649178247`*^9}, {3.5963834485947437`*^9, 
   3.5963834723039007`*^9}, {3.5963844804424467`*^9, 
   3.5963844807862196`*^9}, {3.5967579011981077`*^9, 3.596757904261091*^9}, {
   3.5971892308929095`*^9, 3.597189288766118*^9}, {3.5998480564560623`*^9, 
   3.599848135197772*^9}, {3.5998481854978576`*^9, 3.5998483195720053`*^9}, {
   3.5998483587585106`*^9, 3.599848361430869*^9}, {3.5998493072630906`*^9, 
   3.599849434348357*^9}, {3.5998495060996523`*^9, 3.5998495315274734`*^9}, {
   3.599850468441062*^9, 3.59985052696246*^9}, {3.599850588683849*^9, 
   3.599850601812231*^9}, {3.599850685248019*^9, 3.5998506861543355`*^9}, {
   3.5998507549228506`*^9, 3.599850764441676*^9}, {3.5998508781016254`*^9, 
   3.599850886747609*^9}, {3.5998510228932014`*^9, 3.5998510264092607`*^9}, {
   3.5998532801505256`*^9, 3.599853306037726*^9}, {3.599856460608165*^9, 
   3.599856462748945*^9}, {3.5998573499145937`*^9, 3.5998573533843145`*^9}, {
   3.5999132180148253`*^9, 3.5999132183898525`*^9}, 3.6000050801831007`*^9, {
   3.6013173383084183`*^9, 3.601317340417941*^9}, {3.6013174198356237`*^9, 
   3.601317468564748*^9}, {3.601907551213929*^9, 3.601907565606115*^9}, {
   3.6019075995803623`*^9, 3.6019076177392893`*^9}, {3.6019077144808483`*^9, 
   3.601907714558979*^9}, 3.6025053835143585`*^9, {3.603481741339289*^9, 
   3.603481741544488*^9}, 3.6034819685083013`*^9, {3.603482005289154*^9, 
   3.6034820828320866`*^9}, {3.603482115020148*^9, 3.6034821174985056`*^9}, {
   3.603482303483181*^9, 3.6034823037019496`*^9}, {3.603652058803521*^9, 
   3.6036520716038303`*^9}, 3.6166897994825773`*^9, {3.616689923700183*^9, 
   3.6166899289194794`*^9}, {3.616690096742424*^9, 3.616690112572076*^9}, 
   3.6166901677499456`*^9, {3.6166902135206795`*^9, 3.6166902229122868`*^9}, {
   3.616690260314719*^9, 3.6166902624398727`*^9}, {3.616690371473061*^9, 
   3.6166903739577255`*^9}, 3.6167012793604107`*^9, {3.6167014584893513`*^9, 
   3.6167014905870223`*^9}, {3.616701777693192*^9, 3.616701806493122*^9}, {
   3.616701939790202*^9, 3.61670196313647*^9}, {3.6167020325714507`*^9, 
   3.616702036618698*^9}, {3.6167021485713196`*^9, 3.616702158338005*^9}}],

Cell[BoxData["\<\"Executed\"\>"], "Output",
 CellChangeTimes->{3.6019134116829224`*^9, 3.6166897861843386`*^9}]
}, {2}]],

Cell[TextData[{
 "Load \[Beta] coefficients matrix into ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 "."
}], "Text",
 CellChangeTimes->{{3.6166904566389637`*^9, 3.6166904631084356`*^9}, {
  3.6166905488990917`*^9, 3.616690549274118*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "betaPNRFSAFSORNCNDPFBASCPCDist15NotStandardizedWithInterceptDe1Dm1Gamma09Al\
lRandomFTSet1", "=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fldr", "=", "fldrData"}], ",", 
       RowBox[{
       "name", "=", 
        "\"\<NRFSAFSORNCNDPFBASCPCDist15NotStandardizedWithInterceptDe1Dm1Gamm\
a09AllRandomFTCVTrainingLevel0LambdasFromLevel1Set1Set1\>\""}], ",", 
       RowBox[{"matContacts", "=", 
        RowBox[{
        "matFourSourcesAveragedClosestPointContactMap", 
         "\[LeftDoubleBracket]", 
         RowBox[{"All", ",", 
          RowBox[{"2", ";;", 
           RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"mdSH2Domain", "=", 
        RowBox[{
        "metadataSH2DomainsWithTandemFillsFiveSources", 
         "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "5", ",", "1"}], "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"mdPeptide", "=", 
        RowBox[{
        "metadataPeptidesTrimmedConcatenatedFiveSourcesAugmented", 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
       RowBox[{"distCutoff", "=", "15"}], ",", 
       RowBox[{"alphaIncludedDomain", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"AlphaAAs", ",", "\"\<-\>\""}], "]"}]}], ",", 
       RowBox[{"alphaIncludedPeptide", "=", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"AlphaAAs", ",", 
          RowBox[{"\"\<-\>\"", "|", "\"\<C\>\""}]}], "]"}]}], ",", 
       RowBox[{"alphaExcludedDomain", "=", 
        RowBox[{"{", "\"\<-\>\"", "}"}]}], ",", 
       RowBox[{"alphaExcludedPeptide", "=", 
        RowBox[{"{", 
         RowBox[{"\"\<-\>\"", ",", "\"\<C\>\""}], "}"}]}], ",", "pos"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"pos", "=", 
       RowBox[{"Position", "[", 
        RowBox[{"matContacts", ",", 
         RowBox[{"d_", "/;", 
          RowBox[{"d", "<", "distCutoff"}]}], ",", "2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ImportBetaMatrix", "[", 
       RowBox[{
        RowBox[{"FileNameJoin", "[", 
         RowBox[{"{", 
          RowBox[{"fldr", ",", 
           RowBox[{"\"\<rBeta\>\"", "~~", "name"}]}], "}"}], "]"}], ",", 
        "mdSH2Domain", ",", "mdPeptide", ",", 
        RowBox[{"SecondOrder", "\[Rule]", "pos"}], ",", 
        RowBox[{"pY", "\[Rule]", "True"}], ",", 
        RowBox[{"IncludedResiduesDomain", "\[Rule]", "alphaIncludedDomain"}], 
        ",", 
        RowBox[{
        "IncludedResiduesPeptide", "\[Rule]", "alphaIncludedPeptide"}], ",", 
        RowBox[{"ExcludedResiduesDomain", "\[Rule]", "alphaExcludedDomain"}], 
        ",", 
        RowBox[{
        "ExcludedResiduesPeptide", "\[Rule]", "alphaExcludedPeptide"}]}], 
       "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", "\"\<Loaded\>\""}], "Input",
 CellChangeTimes->{{3.5429992192040987`*^9, 3.542999254260964*^9}, {
   3.5429993281998005`*^9, 3.5429993299646034`*^9}, {3.5430009192448463`*^9, 
   3.543000922012051*^9}, {3.5430011158352146`*^9, 3.5430011641943035`*^9}, {
   3.54300141905018*^9, 3.543001458355852*^9}, {3.543001498519327*^9, 
   3.5430015732962675`*^9}, {3.543169901502221*^9, 3.5431699084778337`*^9}, 
   3.543170028267065*^9, {3.5431700638253326`*^9, 3.543170074131153*^9}, {
   3.543170175237144*^9, 3.5431702120176115`*^9}, {3.5431703247052307`*^9, 
   3.54317032871424*^9}, {3.5431703816761475`*^9, 3.543170384162552*^9}, {
   3.543170741617005*^9, 3.5431707789538755`*^9}, {3.543170809161132*^9, 
   3.5431708398513904`*^9}, {3.5437769041812105`*^9, 3.54377696434831*^9}, {
   3.543777003975175*^9, 3.5437770211286025`*^9}, {3.5437771041017303`*^9, 
   3.54377712301296*^9}, {3.5437786037103744`*^9, 3.5437786405660305`*^9}, {
   3.5437800053703737`*^9, 3.5437800057803745`*^9}, {3.543780586473281*^9, 
   3.5437806255725403`*^9}, 3.546126194162105*^9, {3.5461262564216647`*^9, 
   3.5461264009932175`*^9}, {3.546126511325629*^9, 3.54612652137554*^9}, 
   3.546127618753149*^9, {3.546355001079239*^9, 3.546355041689189*^9}, {
   3.5629431972766647`*^9, 3.5629432152809477`*^9}, {3.562943264533193*^9, 
   3.5629432919026637`*^9}, {3.5629434000793805`*^9, 3.562943410153658*^9}, {
   3.5629434807856145`*^9, 3.562943485099162*^9}, {3.5653544611877966`*^9, 
   3.5653544614715977`*^9}, {3.5703739724419575`*^9, 3.570373984134454*^9}, {
   3.5714427591335735`*^9, 3.571442759515622*^9}, {3.571442972484627*^9, 
   3.5714429864934025`*^9}, {3.571443194780814*^9, 3.5714432238585005`*^9}, {
   3.571443392811925*^9, 3.5714433947561717`*^9}, {3.603926165692187*^9, 
   3.603926167244664*^9}, {3.6040078459157743`*^9, 3.6040080085422325`*^9}, {
   3.6040080580658674`*^9, 3.6040080745833983`*^9}, {3.604008226581643*^9, 
   3.604008226706653*^9}, {3.604008355144104*^9, 3.6040083593226256`*^9}, {
   3.6040084366322546`*^9, 3.6040084461180515`*^9}, {3.616690492392747*^9, 
   3.616690537960275*^9}}],

Cell[BoxData["\<\"Loaded\"\>"], "Output",
 CellChangeTimes->{3.6166905406171*^9}]
}, {2}]]
},
WindowSize->{1424, 817},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 224, 3, 30, "Text"],
Cell[785, 25, 356, 10, 30, "Text"],
Cell[CellGroupData[{
Cell[1166, 39, 558, 11, 52, "Input"],
Cell[1727, 52, 104, 1, 31, "Output"]
}, {2}]],
Cell[1843, 56, 153, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[2021, 62, 582, 15, 72, "Input"],
Cell[2606, 79, 135, 2, 31, "Output"]
}, {2}]],
Cell[2753, 84, 166, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[2944, 94, 520, 13, 52, "Input"],
Cell[3467, 109, 85, 1, 31, "Output"]
}, {2}]],
Cell[3564, 113, 1262, 30, 106, "Text"],
Cell[CellGroupData[{
Cell[4851, 147, 621, 13, 112, "Input"],
Cell[5475, 162, 83, 1, 31, "Output"]
}, {2}]],
Cell[5570, 166, 159, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[5754, 173, 13080, 246, 572, "Input"],
Cell[18837, 421, 81, 1, 31, "Output"]
}, {2}]],
Cell[18930, 425, 124, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[19079, 430, 5803, 95, 152, "Input"],
Cell[24885, 527, 81, 1, 31, "Output"]
}, {2}]],
Cell[24978, 531, 836, 17, 49, "Text"],
Cell[CellGroupData[{
Cell[25839, 552, 14923, 250, 853, "Code",
 InitializationCell->False],
Cell[40765, 804, 111, 1, 31, "Output"]
}, {2}]],
Cell[40888, 808, 245, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[41158, 819, 4962, 97, 192, "Input"],
Cell[46123, 918, 81, 1, 31, "Output"]
}, {2}]]
}
]
*)

(* End of internal cache information *)
